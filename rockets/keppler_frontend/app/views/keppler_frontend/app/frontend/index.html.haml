%section.home
  .home-slider
    - @banners.each do |banner|
      .banner-slider
        .banners-box
          = image_tag banner.image.url, class: 'banner-item'
          .banner-mask
            %h1= banner.title
            %a.btn-more{ href: banner.url, target: '_blank' }
              Ver más
              %i.icofont-arrow-right
        .search-cta
          %h1= banner.search_text
  .search-input
    = simple_form_for @product, url: app_category_path(1), method: :get, class: 'form-inline' do
      .input-group
        %input#search-input.form-control{ type: 'search', placeholder: 'Buscar', name: 'q'}
        .input-group-prepend
          %i.icofont-search.input-group-text
%section.products
  %h1.title Productos
  .row
    .col-lg-9
      .row
        - @products.each do |product|
          .col-lg-4
            .product-card
              %a{ href: app_product_path(product.id) }
                .product-image{ style: "background-image: url('#{product.cover.url}')" }
                  - if product.offer
                    %span.badge.badge-offer Oferta
                  - elsif product.new?
                    %span.badge.badge-new Nuevo
              .product-content
                %a{ href: app_category_path(product.category.id) }
                  %small= product&.category&.name || ''
                %a{ href: app_product_path(product.id) }
                  %h4= product.name
                  .product-price
                    %span= number_to_currency(product.price)
                  .counter
                    %ul
                      %li
                        %span{id: "days#{product.id}"}
                        Dias
                      %li
                        %span{id: "hours#{product.id}"}
                        Horas
                      %li
                        %span{id: "minutes#{product.id}"}
                        Minutos
              %a.product-footer{ href: app_product_path(product.id) }
                .btn-more
                  Solicitar
                  %i.icofont-arrow-right
                
    .col-lg-3
      = publicity('steal_page', KepplerPublicity::Ad.publicity('home-1', 'steal-page'))
      = publicity('steal_page', KepplerPublicity::Ad.publicity('home-2', 'steal-page'))
%section.half_banners
  .row
    .col-lg-6
      = publicity('half_banner', KepplerPublicity::Ad.publicity('home-1', 'half-banner'))
    .col-lg-6
      = publicity('half_banner', KepplerPublicity::Ad.publicity('home-2', 'half-banner'))
- unless @categories_featureds.blank?
  %section.categories
    .row
      .col-lg-3
        .categories-text
          %h1.title Categorías destacadas
          %span Lorem ipsum dolor sit amet consectetur adipisicing elit. Repellendus incidunt temporibus, at consequuntur expedita et quaerat.
        - unless @categories_featureds.size < 3
          .carousel-buttons
            %button.btn.left
              %i.icofont-arrow-left
            %button.btn.right
              %i.icofont-arrow-right
      .col-lg-9
        .row.categories-carousel
          - @categories_featureds.each do |category|
            .category-card
              = image_tag category.image.url
              = link_to app_category_path(category.id), class: 'category-content' do
                %h4= category.name
                %span.btn-more
                  Ver más
                  %i.icofont-arrow-right
%section.full_banner_ad
  .row
    .col-lg-12
      = publicity('banner', KepplerPublicity::Ad.publicity('home-1', 'banner'))
:javascript
  $('.icofont-search').click(function(){
    if ($('#search-input').val().length > 0){
      $('#new_product').submit()
    }
  })
- @products.each do |product|
  :javascript
    var expiration = "#{product.expiration_parsed}"
    var id = "#{product.id}"
    var second = 1000,
        minute = second * 60,
        hour = minute * 60,
        day = hour * 24;

    var countDown = new Date(expiration + " 00:00:00").getTime(),
        now = new Date().getTime(),
        distance = countDown - now;
      
    $('#days'+id).html(Math.floor(distance / (day)))
    $('#hours'+id).html(Math.floor((distance % (day)) / (hour)))
    $('#minutes'+id).html(Math.floor((distance % (hour)) / (minute)))
